# # Define vulnerability patterns
# patterns = {
#     'single': [
#         {'instruction': 'CMD', 'args': '', 'user': False, 'errorNo': 1},
#         {'instruction': 'ENTRYPOINT', 'args': '', 'user': False, 'errorNo': 1},
#         {'instruction': 'USER', 'args': 'root', 'errorNo': 2},
#         {'instruction': 'FROM', 'args': 'latest', 'errorNo': 3},
#         {'instruction': 'ADD', 'args': '', 'errorNo': 4},
#         {'instruction': 'RUN', 'args': 'sudo', 'errorNo': 5},
#         {'instruction': 'RUN', 'args': 'curl --insecure', 'errorNo': 6},
#         {'instruction': 'RUN', 'args': 'curl -k', 'errorNo': 6},
#         {'instruction': 'RUN', 'args': '--no-check-certificate', 'errorNo': 7},
#         {'instruction': 'RUN', 'args': '--trusted-host', 'errorNo': 8},
#         {'instruction': 'RUN', 'args': 'wget', 'errorNo': 9},
#         {'instruction': 'ENV', 'args': 'NODE_TLS_REJECT_UNAUTHORIZED=0', 'errorNo': 10},
#         {'instruction': 'RUN', 'args': '--allow-untrusted', 'errorNo': 11},
#         {'instruction': 'RUN', 'args': '--allow-unauthenticated', 'errorNo': 12},
#         {'instruction': 'RUN', 'args': '--nogpgcheck', 'errorNo': 13},
#         {'instruction': 'RUN', 'args': '--nosignature', 'errorNo': 14},
#         {'instruction': 'RUN', 'args': '--force-yes', 'errorNo': 15},
#         {'instruction': 'RUN', 'args': 'set strict-ssl false', 'errorNo': 16},
#         {'instruction': 'RUN', 'args': '--setopt=sslverify=false', 'errorNo': 17},
#         {'instruction': 'EXPOSE', 'args': '22', 'errorNo': 18},
        
#         # TODO: Check anywhere in the args to have these options. 
#         # TODO: E.g curl --insecure curl can be at the start, and --insecure maybe anywhere after the curl.
        
#         {'instruction': 'ENV', 'args': 'npm_config_strict_ssl=false', 'errorNo': 21},
#         {'instruction': 'ENV', 'args': 'PIP_TRUSTED_HOST', 'errorNo': 22},
#         {'instruction': 'ENV', 'args': 'GIT_SSL_NO_VERIFY=true', 'errorNo': 23},



#     ],
#     'multi': [
#         # {'sequence': ['COPY', 'WORKDIR', 'CMD'], 'description': "Sensitive operations without specifying a non-root user."},
#     ]
# }

# Define vulnerability patterns
[
        {'instruction': 'CMD', 'args': '', 'user': False, 'errorNo': 1},
        {'instruction': 'ENTRYPOINT', 'args': '', 'user': False, 'errorNo': 1},
        {'instruction': 'USER', 'args': 'root', 'errorNo': 2},
        {'instruction': 'FROM', 'args': 'latest', 'errorNo': 3},
        {'instruction': 'ADD', 'args': '', 'errorNo': 4},
        {'instruction': 'RUN', 'args': 'sudo', 'errorNo': 5},
        {'instruction': 'RUN', 'args': 'curl --insecure', 'errorNo': 6},
        {'instruction': 'RUN', 'args': 'curl -k', 'errorNo': 6},
        {'instruction': 'RUN', 'args': '--no-check-certificate', 'errorNo': 7},
        {'instruction': 'RUN', 'args': '--trusted-host', 'errorNo': 8},
        {'instruction': 'RUN', 'args': 'wget', 'errorNo': 9},
        {'instruction': 'ENV', 'args': 'NODE_TLS_REJECT_UNAUTHORIZED=0', 'errorNo': 10},
        {'instruction': 'RUN', 'args': '--allow-untrusted', 'errorNo': 11},
        {'instruction': 'RUN', 'args': '--allow-unauthenticated', 'errorNo': 12},
        {'instruction': 'RUN', 'args': '--nogpgcheck', 'errorNo': 13},
        {'instruction': 'RUN', 'args': '--nosignature', 'errorNo': 14},
        {'instruction': 'RUN', 'args': '--force-yes', 'errorNo': 15},
        {'instruction': 'RUN', 'args': 'set strict-ssl false', 'errorNo': 16},
        {'instruction': 'RUN', 'args': '--setopt=sslverify=false', 'errorNo': 17},
        {'instruction': 'EXPOSE', 'args': '22', 'errorNo': 18},
        
        # TODO: Check anywhere in the args to have these options. 
        # TODO: E.g curl --insecure curl can be at the start, and --insecure maybe anywhere after the curl.
        
        {'instruction': 'ENV', 'args': 'npm_config_strict_ssl=false', 'errorNo': 21},
        {'instruction': 'ENV', 'args': 'PIP_TRUSTED_HOST', 'errorNo': 22},
        {'instruction': 'ENV', 'args': 'GIT_SSL_NO_VERIFY=true', 'errorNo': 23},
    ]


# Tree structure.
# patterns = {
#     'instruction': 'RUN',
#     'args': 'apt-get install',  # Simplified; in practice, you might check more precisely
#     'children': [
#         {
#             'instruction': 'RUN',
#             'args': 'apt-get update',
#             'children': [],  # No specific children in this example
#         }
#     ],
#     'errorNo': 1,  # Assuming there's an error description mapping elsewhere
#     'user': False,  # Assuming this checks that user is not defined specifically for this pattern
# }
