from compose.compose_vulnerability_detection import \
    get_compose_file_vulnerabilities
from dockerfileVulnerability.dockerfile_vulnerability_detection import (
    get_dockerfile_vulnerabilities, get_dockerfile_vulnerabilities_filecontent)
from terraform.terraform_vulnerability_scan import \
    get_terraform_file_vulnerabilities
from utils.file_extension import get_file_extension, get_filename


def get_single_file_vulnerability_filepath(file_path, baseImageScan = False, isVerbose = True):
    if get_file_extension(file_path) == ".Dockerfile" or get_filename(file_path) == "Dockerfile" :
        return get_dockerfile_vulnerabilities(file_path, baseImageScan, isVerbose=isVerbose)
    elif get_file_extension(file_path) == ".yaml" or get_file_extension(file_path) == ".yml":
        # return vectoral_scan(file_path)
        return get_compose_file_vulnerabilities(file_path, isVerbose=isVerbose)
    elif get_file_extension(file_path) == ".tf":
        return get_terraform_file_vulnerabilities(file_path, isVerbose=isVerbose)
    else:
        return
    
def get_single_file_vulnerability_filecontent(file_content, filename, baseImageScan = False, isVerbose = True):
    if get_file_extension(filename) == ".Dockerfile" or get_file_extension(filename) == "Dockerfile" :
        return get_dockerfile_vulnerabilities_filecontent(file_content, baseImageScan, isVerbose=isVerbose)
    elif get_file_extension(filename) == ".yaml" or get_file_extension(filename) == ".yml":
        # TODO:Implement Filecontent.
        return get_compose_file_vulnerabilities(file_content, isVerbose=isVerbose)
    elif get_file_extension(filename) == ".tf":
        # TODO:Implement Filecontent.
        return get_terraform_file_vulnerabilities(file_content, isVerbose=isVerbose)
    else:
        return